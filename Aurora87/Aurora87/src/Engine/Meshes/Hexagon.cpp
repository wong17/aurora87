#include "Hexagon.h"

namespace Engine
{
	std::shared_ptr<Mesh> Hexagon::GenerateMesh() const
	{
        std::vector<float> vertices = {
			// Posición                 // normales                 // Coordenadas de textura
                  0.0f,  0.0f,   0.0f,  -0.0f, -1.0f,     -0.0f,         0.5f,   0.5f,
            -0.433013f,  0.0f, -0.25f,  -0.0f, -1.0f,     -0.0f,    0.066987f,  0.75f,
                  0.0f,  0.0f,  -0.5f,  -0.0f, -1.0f,     -0.0f,         0.5f,   1.0f,
                  0.0f,  0.0f,   0.0f,  -0.0f, -1.0f,     -0.0f,         0.5f,   0.5f,
            -0.433013f,  0.0f,  0.25f,  -0.0f, -1.0f,     -0.0f,    0.066987f,  0.25f,
            -0.433013f,  0.0f, -0.25f,  -0.0f, -1.0f,     -0.0f,    0.066987f,  0.75f,
                  0.0f,  0.0f,   0.0f,  -0.0f, -1.0f,     -0.0f,         0.5f,   0.5f,
                  0.0f,  0.0f,   0.5f,  -0.0f, -1.0f,     -0.0f,         0.5f,   0.0f,
            -0.433013f,  0.0f,  0.25f,  -0.0f, -1.0f,     -0.0f,    0.066987f,  0.25f,
                  0.0f,  0.0f,   0.0f,  -0.0f, -1.0f,     -0.0f,         0.5f,   0.5f,
             0.433013f,  0.0f,  0.25f,  -0.0f, -1.0f,     -0.0f,    0.933013f,  0.25f,
                  0.0f,  0.0f,   0.5f,  -0.0f, -1.0f,     -0.0f,         0.5f,   0.0f,
                  0.0f,  0.0f,   0.0f,  -0.0f, -1.0f,     -0.0f,         0.5f,   0.5f,
             0.433013f,  0.0f, -0.25f,  -0.0f, -1.0f,     -0.0f,    0.933013f,  0.75f,
             0.433013f,  0.0f,  0.25f,  -0.0f, -1.0f,     -0.0f,    0.933013f,  0.25f,
                  0.0f,  0.0f,   0.0f,  -0.0f, -1.0f,     -0.0f,         0.5f,   0.5f,
                  0.0f,  0.0f,  -0.5f,  -0.0f, -1.0f,     -0.0f,         0.5f,   1.0f,
             0.433013f,  0.0f, -0.25f,  -0.0f, -1.0f,     -0.0f,    0.933013f,  0.75f,
                  0.0f, 0.25f,   0.0f,  -0.0f,  1.0f,     -0.0f,         0.5f,   0.5f,
                  0.0f, 0.25f,  -0.5f,  -0.0f,  1.0f,     -0.0f,         0.5f,   1.0f,
            -0.433013f, 0.25f, -0.25f,  -0.0f,  1.0f,     -0.0f,    0.066987f,  0.75f,
                  0.0f, 0.25f,   0.0f,  -0.0f,  1.0f,     -0.0f,         0.5f,   0.5f,
            -0.433013f, 0.25f, -0.25f,  -0.0f,  1.0f,     -0.0f,    0.066987f,  0.75f,
            -0.433013f, 0.25f,  0.25f,  -0.0f,  1.0f,     -0.0f,    0.066987f,  0.25f,
                  0.0f, 0.25f,   0.0f,  -0.0f,  1.0f,     -0.0f,         0.5f,   0.5f,
            -0.433013f, 0.25f,  0.25f,  -0.0f,  1.0f,     -0.0f,    0.066987f,  0.25f,
                  0.0f, 0.25f,   0.5f,  -0.0f,  1.0f,     -0.0f,         0.5f,   0.0f,
                  0.0f, 0.25f,   0.0f,  -0.0f,  1.0f,     -0.0f,         0.5f,   0.5f,
                  0.0f, 0.25f,   0.5f,  -0.0f,  1.0f,     -0.0f,         0.5f,   0.0f,
             0.433013f, 0.25f,  0.25f,  -0.0f,  1.0f,     -0.0f,    0.933013f,  0.25f,
                  0.0f, 0.25f,   0.0f,  -0.0f,  1.0f,     -0.0f,         0.5f,   0.5f,
             0.433013f, 0.25f,  0.25f,  -0.0f,  1.0f,     -0.0f,    0.933013f,  0.25f,
             0.433013f, 0.25f, -0.25f,  -0.0f,  1.0f,     -0.0f,    0.933013f,  0.75f,
                  0.0f, 0.25f,   0.0f,  -0.0f,  1.0f,     -0.0f,         0.5f,   0.5f,
             0.433013f, 0.25f, -0.25f,  -0.0f,  1.0f,     -0.0f,    0.933013f,  0.75f,
                  0.0f, 0.25f,  -0.5f,  -0.0f,  1.0f,     -0.0f,         0.5f,   1.0f,
             0.433013f,  0.0f, -0.25f,   0.5f, -0.0f,   -0.866f,    0.933013f,  0.75f,
                  0.0f,  0.0f,  -0.5f,   0.5f, -0.0f,   -0.866f,         0.5f,   1.0f,
                  0.0f, 0.25f,  -0.5f,   0.5f, -0.0f,   -0.866f,         0.5f,   1.0f,
             0.433013f,  0.0f, -0.25f,   0.5f, -0.0f,   -0.866f,    0.933013f,  0.75f,
                  0.0f, 0.25f,  -0.5f,   0.5f, -0.0f,   -0.866f,         0.5f,   1.0f,
             0.433013f, 0.25f, -0.25f,   0.5f, -0.0f,   -0.866f,    0.933013f,  0.75f,
                  0.0f,  0.0f,  -0.5f,  -0.5f, -0.0f,   -0.866f,         0.5f,   1.0f,
            -0.433013f,  0.0f, -0.25f,  -0.5f, -0.0f,   -0.866f,    0.066987f,  0.75f,
            -0.433013f, 0.25f, -0.25f,  -0.5f, -0.0f,   -0.866f,    0.066987f,  0.75f,
                  0.0f,  0.0f,  -0.5f,  -0.5f, -0.0f,   -0.866f,         0.5f,   1.0f,
            -0.433013f, 0.25f, -0.25f,  -0.5f, -0.0f,   -0.866f,    0.066987f,  0.75f,
                  0.0f, 0.25f,  -0.5f,  -0.5f, -0.0f,   -0.866f,         0.5f,   1.0f,
             0.433013f,  0.0f,  0.25f,   1.0f, -0.0f,     -0.0f,    0.933013f,  0.25f,
             0.433013f,  0.0f, -0.25f,   1.0f, -0.0f,     -0.0f,    0.933013f,  0.75f,
             0.433013f, 0.25f, -0.25f,   1.0f, -0.0f,     -0.0f,    0.933013f,  0.75f,
             0.433013f,  0.0f,  0.25f,   1.0f, -0.0f,     -0.0f,    0.933013f,  0.25f,
             0.433013f, 0.25f, -0.25f,   1.0f, -0.0f,     -0.0f,    0.933013f,  0.75f,
             0.433013f, 0.25f,  0.25f,   1.0f, -0.0f,     -0.0f,    0.933013f,  0.25f,
                  0.0f,  0.0f,   0.5f,   0.5f, -0.0f,    0.866f,         0.5f,   0.0f,
             0.433013f,  0.0f,  0.25f,   0.5f, -0.0f,    0.866f,    0.933013f,  0.25f,
             0.433013f, 0.25f,  0.25f,   0.5f, -0.0f,    0.866f,    0.933013f,  0.25f,
                  0.0f,  0.0f,   0.5f,   0.5f, -0.0f,    0.866f,         0.5f,   0.0f,
             0.433013f, 0.25f,  0.25f,   0.5f, -0.0f,    0.866f,    0.933013f,  0.25f,
                  0.0f, 0.25f,   0.5f,   0.5f, -0.0f,    0.866f,         0.5f,   0.0f,
            -0.433013f,  0.0f,  0.25f,  -0.5f, -0.0f,    0.866f,    0.066987f,  0.25f,
                  0.0f,  0.0f,   0.5f,  -0.5f, -0.0f,    0.866f,         0.5f,   0.0f,
                  0.0f, 0.25f,   0.5f,  -0.5f, -0.0f,    0.866f,         0.5f,   0.0f,
            -0.433013f,  0.0f,  0.25f,  -0.5f, -0.0f,    0.866f,    0.066987f,  0.25f,
                  0.0f, 0.25f,   0.5f,  -0.5f, -0.0f,    0.866f,         0.5f,   0.0f,
            -0.433013f, 0.25f,  0.25f,  -0.5f, -0.0f,    0.866f,    0.066987f,  0.25f,
            -0.433013f,  0.0f, -0.25f,  -1.0f, -0.0f,     -0.0f,    0.066987f,  0.75f,
            -0.433013f,  0.0f,  0.25f,  -1.0f, -0.0f,     -0.0f,    0.066987f,  0.25f,
            -0.433013f, 0.25f,  0.25f,  -1.0f, -0.0f,     -0.0f,    0.066987f,  0.25f,
            -0.433013f,  0.0f, -0.25f,  -1.0f, -0.0f,     -0.0f,    0.066987f,  0.75f,
            -0.433013f, 0.25f,  0.25f,  -1.0f, -0.0f,     -0.0f,    0.066987f,  0.25f,
            -0.433013f, 0.25f, -0.25f,  -1.0f, -0.0f,     -0.0f,    0.066987f,  0.75f
        };

		for (size_t i = 0; i < vertices.size(); i += 8) {
			vertices[i + 0] *= m_Size.x; // x
			vertices[i + 1] *= m_Size.y; // y
			vertices[i + 2] *= m_Size.z; // z
		}

        std::vector<TextureData> textures;
        auto material = MaterialTextureType::Diffuse;
        if (m_Texture)
        {
            textures.push_back({
                material,
                m_Texture,
                MaterialTextureUniformName(material),
                0,
                m_Texture->GetSpecification().SRGB });
        }
        else if (!m_TexturePath.empty())
        {
            TextureSpecification spec;
            spec.SRGB = true;

            if (auto tex = TextureManager::Get().Load(m_TexturePath, spec))
                textures.push_back({ material, tex, MaterialTextureUniformName(material), 0, spec.SRGB });
            else
                std::cerr << "Hexagon::GenerateMesh(): Error al cargar la textura " << m_TexturePath << "\n";
        }

		return std::make_shared<Mesh>(vertices, textures);
	}
}